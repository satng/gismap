<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>methods/base.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="AreaEvent.AreaEvent.html">AreaEvent</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="GisMap.html">GisMap</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.addCameraEvent">addCameraEvent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.addMouseEvent">addMouseEvent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.canvas2image">canvas2image</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.clearSky">clearSky</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.getCameraHeight">getCameraHeight</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.getCameraPosition">getCameraPosition</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.getLayer">getLayer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.getLayerValues">getLayerValues</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.layerHide">layerHide</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.layerRemove">layerRemove</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.layerShow">layerShow</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.removeCameraEvent">removeCameraEvent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.removeMouseEvent">removeMouseEvent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.resetSky">resetSky</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.setSceneMode2D3D">setSceneMode2D3D</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.setSky">setSky</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.zoomIn">zoomIn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#.zoomOut">zoomOut</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#clearWeather">clearWeather</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#destroy">destroy</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#drawPolyLine">drawPolyLine</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#remove">remove</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#removeAll">removeAll</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#setView">setView</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="GisMap.html#setWeather">setWeather</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="LoadCzml.html">LoadCzml</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="LoadCzml.html#bindStallite">bindStallite</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="LoadCzml.html#load">load</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="LoadCzml.html#remove">remove</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="LoadCzml.html#unbindStallite">unbindStallite</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="LoadCzml.LoadCzml.html">LoadCzml</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="MeasureLine.html">MeasureLine</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="MeasureLine.html#destroy">destroy</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="MeasureLine.html#finish">finish</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="MeasureLine.MeasureLine.html">MeasureLine</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="MeasurePolygn.html">MeasurePolygn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="MeasurePolygn.html#destroy">destroy</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="MeasurePolygn.html#finish">finish</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="MeasurePolygn.MeasurePolygn.html">MeasurePolygn</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SelectCircle.html">SelectCircle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SelectCircle.html#finish">finish</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SelectCircle.SelectCircle.html">SelectCircle</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SelectRect.html">SelectRect</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="SelectRect.html#finish">finish</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="SelectRect.SelectRect.html">SelectRect</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li>
</nav>

<div id="main">
    
    <h1 class="page-title">methods/base.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Canvas2Image from './canvas2image';
// view zoomTo
// function zoomTo() {
//   this.viewer.zoomTo();
// }

/**
   *
   * 缩进视图
   * @memberof GisMap
   * @param {number} [scale = 0.5] 缩进视视图系数1为，缩进已有距离一半,默认0.5
   * @return {number} scale
   */
function zoomIn(scale = 0.5) {
  // 获取当前镜头位置的笛卡尔坐标
  const cameraPos = this.camera.position;

  // // 获取当前坐标系标准
  const { ellipsoid } = this.scene.globe;

  // // 根据坐标系标准，将笛卡尔坐标转换为地理坐标
  const cartographic = ellipsoid.cartesianToCartographic(cameraPos);

  // // 获取镜头的高度
  const { height } = cartographic;
  const _scale = (1 - (1 / (scale + 1))) * height;
  // 优化？
  this.camera.zoomIn(_scale);
  return scale;
}

/**
   *
   * 放大视图
   * @memberof GisMap
   * @param {number} [scale = 0.5] 放大视系数1为一倍视距,默认0.5
   * @return {number} scale
   */
function zoomOut(scale = 0.5) {
  // 获取当前镜头位置的笛卡尔坐标
  const cameraPos = this.camera.position;

  // // 获取当前坐标系标准
  const { ellipsoid } = this.scene.globe;

  // // 根据坐标系标准，将笛卡尔坐标转换为地理坐标
  const cartographic = ellipsoid.cartesianToCartographic(cameraPos);

  // // 获取镜头的高度
  const { height } = cartographic;
  const _scale = height * (1 + scale);
  this.camera.zoomOut(_scale);
  return _scale;
}

/**
   *
   * 切换2D/3D模式
   * @memberof GisMap
   * @param {"2｜3"} [mode] 2或3，不传参数默认切换
   * @returns {"2｜3"}
   * 
   */
function setSceneMode2D3D(mode) {
  let _mode = 3;
  const { Cesium } = this;
  if (mode === 3) {
    this.viewer.scene.mode = Cesium.SceneMode.SCENE3D;
    _mode = 3
  } else if (mode === 2) {
    this.viewer.scene.mode = Cesium.SceneMode.SCENE2D;
    _mode = 2
  } else if (this.viewer.scene.mode === Cesium.SceneMode.SCENE3D) {
    this.viewer.scene.mode = Cesium.SceneMode.SCENE2D;
    _mode = 2
  } else {
    this.viewer.scene.mode = Cesium.SceneMode.SCENE3D;
    _mode = 3
  }
  return _mode
}
/**
 * 自定义星空背景图
 * @memberof GisMap
 * @param {string[]} sources 参考视角[右,左,下,上,前,后]
 */
function setSky(sources) {
  const { viewer, Cesium } = this;
  viewer.scene.skyBox = new Cesium.SkyBox({
    sources: {
      positiveX: sources[0],
      negativeX: sources[1],
      positiveY: sources[2],
      negativeY: sources[3],
      positiveZ: sources[4],
      negativeZ: sources[5],
    },
  });
}
/**
 *
 * 恢复默认星空背景图
 * @memberof GisMap
 */
function resetSky() {
  const { viewer, Cesium } = this;
  const baseUrl = globalThis.CESIUM_BASE_URL;
  viewer.scene.skyBox = new Cesium.SkyBox({
    sources: {
      positiveX: `${baseUrl}/Assets/Textures/SkyBox/tycho2t3_80_px.jpg`,
      negativeX: `${baseUrl}/Assets/Textures/SkyBox//tycho2t3_80_mx.jpg`,
      positiveY: `${baseUrl}/Assets/Textures/SkyBox//tycho2t3_80_py.jpg`,
      negativeY: `${baseUrl}/Assets/Textures/SkyBox//tycho2t3_80_my.jpg`,
      positiveZ: `${baseUrl}/Assets/Textures/SkyBox//tycho2t3_80_pz.jpg`,
      negativeZ: `${baseUrl}/Assets/Textures/SkyBox//tycho2t3_80_mz.jpg`,
    },
  });
}

/**
 *
 * 隐藏星空背景
 * @memberof GisMap
 */
function clearSky() {
  const { viewer } = this;
  viewer.scene.skyBox.show = false;
}
/**
 *
 *  截屏截图功能
 * @memberof GisMap
 * @param {('file'|'base64'|'img')} [type = 'file']  返回图片类型 【file】返回下载文件；【base64】返回base64格式数据 【img】返回DOM
 * @param {number} [width]  返回图片宽度 默认为画布宽度
 * @param {number} [height] 返回图片高度 默认为画布高度
 * @return {img} img 图片
 */
// eslint-disable-next-line default-param-last
function canvas2image(type = 'file', width, height) {
  const { viewer } = this;
  const { canvas } = viewer.scene;
  const _width = width || canvas.width;
  const _height = height || canvas.height;
  let img = null;
  switch (type) {
    case 'base64':
      img = Canvas2Image.saveAsData(canvas, _width, _height, 'png');
      break;
    case 'img':
      img = Canvas2Image.convertToImage(canvas, _width, _height, 'png');
      break;
    default:
      img = Canvas2Image.saveAsImage(canvas, _width, _height, 'png');
      break;
  }

  return img;
}

export default {
  zoomOut,
  zoomIn,
  setSceneMode2D3D,
  setSky,
  resetSky,
  clearSky,
  canvas2image,
};
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a> on Fri Jul 08 2022 14:56:52 GMT+0800 (中国标准时间) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
